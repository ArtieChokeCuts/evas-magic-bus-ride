<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
        <title>Eva's Magic Bus Ride</title>
        <style>
            * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }
            body { overflow: hidden; background: #87ceeb; font-family: "Comic Sans MS", sans-serif; }
            #hud { position: absolute; inset: 0; pointer-events: none; z-index: 10; display: flex; justify-content: space-between; padding: 20px; }
            #top-center { position: absolute; top: 10px; width: 100%; display: flex; justify-content: center; gap: 40px; z-index: 20; }
            .star-goal { position: relative; width: 140px; height: 140px; display: flex; align-items: center; justify-content: center; animation: float 4s infinite; }
            .star-bg { position: absolute; font-size: 160px; color: #ffc107; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3)); }
            .star-content { position: relative; z-index: 2; font-size: 2.5rem; font-weight: 900; color: #fff; text-shadow: 2px 2px #000; }
            #splash { position: fixed; inset: 0; background: #87ceeb; z-index: 100; display: flex; align-items: center; justify-content: center; }
            #start-btn { padding: 20px 50px; font-size: 2rem; background: #ffe44d; border-radius: 50px; cursor: pointer; }
            @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
            canvas { display: block; position: absolute; inset: 0; }
        </style>
    </head>
    <body>
        <div id="splash"><button id="start-btn">START MAGIC BUS!</button></div>
        <div id="top-center">
            <div class="star-goal"><div class="star-bg">â˜…</div><div class="star-content" id="goal-text">EVA</div></div>
        </div>
        <canvas id="webgl"></canvas>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
        <script>
            const state = { playing: false, target: "EVA", index: 0, alphabet: "ABCDEFGHIJKLMNOPQRSTUVWXYZ", numbers: Array.from({length: 25}, (_, i) => i + 1) };
            let scene, camera, renderer, evaBus;
            const bubbles = [];
    
            function init() {
                renderer = new THREE.WebGLRenderer({ canvas: document.querySelector('#webgl'), alpha: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 100);
                camera.position.z = 8;
    
                const loader = new THREE.TextureLoader();
                loader.load('eva_bus.png', (tex) => {
                    const mat = new THREE.SpriteMaterial({ map: tex });
                    evaBus = new THREE.Sprite(mat);
                    evaBus.scale.set(3, 2, 1);
                    scene.add(evaBus);
                });
    
                window.addEventListener('pointerdown', onTap);
                document.getElementById('start-btn').onclick = () => { 
                    document.getElementById('splash').style.display = 'none'; 
                    state.playing = true; 
                    for(let i=0; i<15; i++) spawnBubble();
                };
                animate();
            }
    
            function spawnBubble(existing = null) {
                const bubble = existing || new THREE.Mesh(new THREE.SphereGeometry(0.5, 32, 32), new THREE.MeshStandardMaterial({ transparent: true, opacity: 0.6 }));
                if (bubble.userData.sprite) bubble.remove(bubble.userData.sprite);
                const can = document.createElement('canvas'); can.width = 128; can.height = 128;
                const ctx = can.getContext('2d');
                ctx.fillStyle = "#FFF"; ctx.font = "bold 80px Arial"; ctx.textAlign = "center"; ctx.textBaseline = "middle";
                const val = Math.random() > 0.5 ? state.alphabet[Math.floor(Math.random()*26)] : state.numbers[Math.floor(Math.random()*25)];
                ctx.fillText(val, 64, 64);
                const sprite = new THREE.Sprite(new THREE.SpriteMaterial({ map: new THREE.CanvasTexture(can) }));
                sprite.scale.set(0.7, 0.7, 1);
                bubble.add(sprite);
                bubble.position.set((Math.random()-0.5)*10, -6 - Math.random()*5, (Math.random()-0.5)*2);
                bubble.userData = { val, sprite, speed: 0.02 + Math.random()*0.03 };
                if(!existing) { scene.add(bubble); bubbles.push(bubble); }
            }
    
            function onTap(e) {
                if(!state.playing) return;
                const mouse = new THREE.Vector2((e.clientX/window.innerWidth)*2-1, -(e.clientY/window.innerHeight)*2+1);
                const ray = new THREE.Raycaster(); ray.setFromCamera(mouse, camera);
                const hits = ray.intersectObjects(bubbles);
                if(hits.length > 0) {
                    const b = hits[0].object;
                    if(b.userData.val === state.target[state.index]) {
                        state.index++;
                        b.material.color.set(0xffff00);
                        if(state.index >= state.target.length) { state.index = 0; }
                        document.getElementById('goal-text').innerText = state.target.substring(0, state.index) + "_".repeat(state.target.length - state.index);
                    }
                    spawnBubble(b);
                }
            }
    
            function animate() {
                requestAnimationFrame(animate);
                if(state.playing) bubbles.forEach(b => { b.position.y += b.userData.speed; if(b.position.y > 6) spawnBubble(b); });
                renderer.render(scene, camera);
            }
            init();
        </script>
    </body>
    </html>
    
